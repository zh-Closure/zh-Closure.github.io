<!DOCTYPE html>
<html lang="zh-CN" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="" />
  <meta name="author" content="Closure" />
  <meta name="description" content="" />
  <meta name="google-site-verification" content="ume8wxFIzFnN-uS2NK6TLbEnB0OL8U3QYLpG-0v0NPM" />
  
  
  <title>
    
      BLE_CTF 
      
      
      |
    
     Closure
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- 代码块风格 -->
  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">Closure</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">主页</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">归档</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">关于我</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">BLE_CTF</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="更新时间"></i>
          2024-03-03 22:46:00
        </span>
        
              <span class="post-tags">
                <i class="iconfont icon-tags mr-10" title="标签"></i>
                
                <span class="span--tag mr-8">
                  <a href="/tags/BLE/" title="BLE">
                    #BLE
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <h1 id="BLE-CTF"><a href="#BLE-CTF" class="headerlink" title="BLE_CTF"></a>BLE_CTF</h1><p>刚好有一块esp32，来玩玩看</p>
<h2 id="环境部署"><a href="#环境部署" class="headerlink" title="环境部署"></a>环境部署</h2><p>项目地址：</p>
<pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;hackgnar&#x2F;ble_ctf</code></pre>



<p>根据文档烧录固件（刚好有flash_download_tool就不用esptool了）：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403021906252.png" alt="image-20240302190635230"></p>
<p>通过flash_download_tool烧录固件：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403021724748.png" alt="image-20240302172437655"></p>
<p>烧录完成</p>
<p>安装一些工具：bluetooth</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> bluetooth

<span class="token comment">#hciconfig：利用笔记本电脑的主机控制器接口与BLE设备进行通信和读写更改。</span>
hciconfig <span class="token comment">#查看蓝牙设备</span>
hciconfig hci0 up
<span class="token function">sudo</span> hciconfig hci0 lestates <span class="token comment">#启用hci0</span></code></pre>



<h2 id="开始挑战"><a href="#开始挑战" class="headerlink" title="开始挑战"></a>开始挑战</h2><p>扫描周围BLE设备&#x3D;&#x3D;》BLECTF</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">bluetoothctl scan le</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022101062.png" alt="image-20240302210130015"></p>
<p>通过gatttool与蓝牙设备进行交互：</p>
<p>获取分数，从42句柄读取，目前是0</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> <span class="token punctuation">[</span>MAC<span class="token punctuation">]</span> --char-read <span class="token parameter variable">-a</span> 0x002a<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">':'</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token operator">|</span><span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">' '</span><span class="token operator">|</span>xxd <span class="token parameter variable">-r</span> -p<span class="token punctuation">;</span><span class="token builtin class-name">printf</span> <span class="token string">'\n'</span> </code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022106027.png" alt="image-20240302210644958"></p>
<p>提交flag&#x3D;》向44句柄写入（提交）</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> <span class="token punctuation">[</span>MAC<span class="token punctuation">]</span> --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"some flag value"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>



<p>开始挑战：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022112559.png" alt="image-20240302211256492"></p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><pre class="language-none"><code class="language-none">Flag one is a gift! You can only obtain it by reading this document or peaking at the source code. In short, this flag is to get you familiar with doing a simple write to a BLE handle. Do the following to get your first flag. Make sure you replace the MAC address in the examples below with your devices mac address!

First, check out your score:
gatttool -b de:ad:be:ef:be:f1 --char-read -a 0x002a|awk -F&#39;:&#39; &#39;&#123;print $2&#125;&#39;|tr -d &#39; &#39;|xxd -r -p;printf &#39;\n&#39;

Next, lets sumbmit the following flag. gatttool -b de:ad:be:ef:be:f1 --char-write-req -a 0x002c -n $(echo -n &quot;12345678901234567890&quot;|xxd -ps)

Finaly, check out your score again to see your flag got accepted:
gatttool -b de:ad:be:ef:be:f1 --char-read -a 0x002a|awk -F&#39;:&#39; &#39;&#123;print $2&#125;&#39;|tr -d &#39; &#39;|xxd -r -p;printf &#39;\n&#39;</code></pre>

<p>教你怎么提交flag</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"12345678901234567890"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022116277.png" alt="image-20240302211619198"></p>
<h3 id="0x002e"><a href="#0x002e" class="headerlink" title="0x002e"></a>0x002e</h3><pre class="language-none"><code class="language-none">Check out the ascii value of handle 0x002e and submit it to the flag submision handle 0x002c. If you are using gatttool, make sure you convert it to hex with xxd. If you are using bleah, you can send it as a string value.</code></pre>

<p>查看0x002e句柄的ASCII值&#x3D;&#x3D;》</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x002e</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022128570.png" alt="image-20240302212829517"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"d205303e099ceff44835"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022131565.png" alt="image-20240302213121475"></p>
<h3 id="0x0030"><a href="#0x0030" class="headerlink" title="0x0030"></a>0x0030</h3><pre class="language-none"><code class="language-none">Check out the ascii value of handle 0x0030. Do what it tells you and submit the flag you find to 0x002c.</code></pre>

<p>检查0x0030句柄的ASCII：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0030</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022137821.png" alt="image-20240302213700752"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022137543.png" alt="image-20240302213746490"></p>
<p>&#x3D;&#x3D;》将设备的名称MD5，也就是BLECTF的MD5：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022151423.png" alt="image-20240302215149387"></p>
<p>提交：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"5cd56d74049ae40f442ece036c6f4f06"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022232451.png" alt="image-20240302223248345"></p>
<p>失败&#x3D;&#x3D;》因为蓝牙低功耗（BLE）规范限制了一次性写入的数据长度为<strong>20个字节</strong>。如果要发送的数据长度超过了这个限制，就需要将数据<strong>分割</strong>成多个部分，每次发送不超过20个字节字节。</p>
<p>截取前20字节提交：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"5cd56d74049ae40f442e"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022235543.png" alt="image-20240302223515442"></p>
<h3 id="0x0016"><a href="#0x0016" class="headerlink" title="0x0016"></a>0x0016</h3><pre class="language-none"><code class="language-none">Bluetooth GATT services provide some extra device attributes. Try finding the value of the Generic Access -&gt; Device Name.</code></pre>

<p>依旧是读取0x0016句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0016</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022320464.png" alt="image-20240302232019387"></p>
<p>&#x3D;&#x3D;》转ASCII</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022319663.png"></p>
<p>&#x3D;&#x3D;》截取前20字节提交</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"2b00042f7481c7b056c4"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022330613.png" alt="image-20240302233016535"></p>
<h3 id="0x0032"><a href="#0x0032" class="headerlink" title="0x0032"></a>0x0032</h3><pre class="language-none"><code class="language-none">Read handle 0032 and do what it says. Notice that its not telling you to write to the flag handle as you have been. When you find the flag, go ahead and write it to the flag handle you have used in the past flags.</code></pre>

<p>读取0x0032句柄</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0032</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022332421.png" alt="image-20240302233237362"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022333736.png" alt="image-20240302233339691"></p>
<p>随便写点什么&#x3D;&#x3D;》写个Closure（注意是往0x0032句柄里写）</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0032 <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"Closure"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022336880.png"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022335326.png" alt="image-20240302233555287"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"3873c0270763568cf7aa"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022337352.png" alt="image-20240302233756247"></p>
<h3 id="0x0034"><a href="#0x0034" class="headerlink" title="0x0034"></a>0x0034</h3><pre class="language-none"><code class="language-none">Follow the instructions found from reading handle 0x0034. Keep in mind that some tools only write hex values while other provide methods for writing either hex or ascii</code></pre>

<p>读取0x0034句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0034</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022348958.png" alt="image-20240302234842892"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403022340011.png" alt="image-20240302234023470"></p>
<p>需要写入yo的ASCII值到0x0034句柄&#x3D;&#x3D;》</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0034 <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"yo"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030009825.png" alt="image-20240303000956734"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030010224.png" alt="image-20240303001009172"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"c55c6314b3db0a6128af"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030011715.png" alt="image-20240303001113582"></p>
<h3 id="0x0036"><a href="#0x0036" class="headerlink" title="0x0036"></a>0x0036</h3><pre class="language-none"><code class="language-none">Follow the instructions found from reading handle 0x0036. Keep in mind that some tools only write hex values while other provide methods for writing either hex or ascii</code></pre>

<p>读取0x0036句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0036</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030027290.png" alt="image-20240303002744234"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030027887.png" alt="image-20240303002728825"></p>
<p>写入一个0x07&#x3D;&#x3D;》</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> 07</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030030068.png" alt="image-20240303003000986"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030029324.png" alt="image-20240303002945280"></p>
<p>提交一下flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"1179080b29f8da16ad66"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030030610.png" alt="image-20240303003049495"></p>
<h3 id="0x0038"><a href="#0x0038" class="headerlink" title="0x0038"></a>0x0038</h3><pre class="language-none"><code class="language-none">Follow the instructions found from reading handle 0x0038. Pay attention to handles here. Keep in mind handles can be refrenced by integer or hex. Most tools such as gatttool and bleah allow you to specify handles both ways.</code></pre>

<p>读取0x0038句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0038</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030032409.png" alt="image-20240303003246353"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030032052.png" alt="image-20240303003237022"></p>
<p>将0xc9写入58句柄里&#x3D;&#x3D;》其实就是说十六进制和十进制都可以表示句柄吧</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> <span class="token number">58</span> <span class="token parameter variable">-n</span> c9</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030045316.png" alt="image-20240303004531244"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030045004.png" alt="image-20240303004520947"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"f8b136d937fad6a2be9f"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030046118.png" alt="image-20240303004618001"></p>
<h3 id="0x003c"><a href="#0x003c" class="headerlink" title="0x003c"></a>0x003c</h3><pre class="language-none"><code class="language-none">Take a look at handle 0x003c and do what it says. You should script up a solution for this one. Also keep in mind that some tools write faster than others.</code></pre>

<p>读取0x003c句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x003c</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030048573.png" alt="image-20240303004840511"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030048406.png" alt="image-20240303004830345"></p>
<p>需要我们从00爆破到ff：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">import</span> subprocess
<span class="token function">import</span> <span class="token function">time</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>:
    x <span class="token operator">=</span> format<span class="token punctuation">(</span>i, <span class="token string">'02x'</span><span class="token punctuation">)</span>  <span class="token comment"># 将整数 i 格式化为两位的十六进制字符串</span>
    payload <span class="token operator">=</span> <span class="token string">"gatttool -b D8:BC:38:F9:72:12 --char-write-req -a 0x003c -n "</span> + x
    print<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    subprocess.run<span class="token punctuation">(</span>payload, <span class="token assign-left variable">shell</span><span class="token operator">=</span>True<span class="token punctuation">)</span>
    time.sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span></code></pre>

<p>些许等待后：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030100272.png" alt="image-20240303010038991"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030100471.png" alt="image-20240303010014415"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"933c1fcfa8ed52d2ec05"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403030101068.png" alt="image-20240303010142995"></p>
<h3 id="0x003e"><a href="#0x003e" class="headerlink" title="0x003e"></a>0x003e</h3><pre class="language-none"><code class="language-none">Talke a look at handle 0x003e and do what it says. Keep in mind that some tools have better connection speeds than other for doing reads and writes. This has to do with the functionality the tool provides or how it uses cached BT connections on the host OS. Try testing different tools for this flag. Once you find the fastest one, whip up a script or bash 1 liner to complete the task. FYI, once running, this task takes roughly 90 seconds to complete if done right.</code></pre>

<p>读取0x003e句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x003e</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031441661.png" alt="image-20240303144125629"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031441928.png" alt="image-20240303144116873"></p>
<p>需要我们读1000遍，一样写个python执行下：</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> time

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> <span class="token string">"gatttool -b D8:BC:38:F9:72:12 --char-read -a 0x003e"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031450395.png" alt="image-20240303145049333"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031505401.png" alt="image-20240303150500370"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"6ffcd214ffebdc0d069e"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031509709.png"></p>
<h3 id="0x0040"><a href="#0x0040" class="headerlink" title="0x0040"></a>0x0040</h3><pre class="language-none"><code class="language-none">Check out handle 0x0040 and google search gatt notify. Some tools like gatttool have the ability to subscribe to gatt notifications</code></pre>

<p>读取0x0040句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0040</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031515493.png"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031514284.png" alt="image-20240303151458245"></p>
<p>需要我们通过gatttool监听从蓝牙发送过来的通知（notification）数据：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0040 <span class="token parameter variable">-n</span> 00 <span class="token parameter variable">--listen</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031523169.png" alt="image-20240303152318073"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031524145.png" alt="image-20240303152419093"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"5ec3772bcd00cf06d8eb"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031524961.png" alt="image-20240303152404878"></p>
<h3 id="0x0042"><a href="#0x0042" class="headerlink" title="0x0042"></a>0x0042</h3><pre class="language-none"><code class="language-none">Check out handle 0x0042 and google search gatt indicate. For single response indicate messages, like this challenge, tools such as gatttool will work just fine.</code></pre>

<p>读取0x0042句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0042</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031526720.png" alt="image-20240303152638628"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031526946.png" alt="image-20240303152626878"></p>
<p>监听0x0044句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0044 <span class="token parameter variable">-n</span> 00 <span class="token parameter variable">--listen</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031528762.png" alt="image-20240303152847674"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031529553.png"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"c7b86dd121848c77c113"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031530346.png" alt="image-20240303153015260"></p>
<h3 id="0x0046"><a href="#0x0046" class="headerlink" title="0x0046"></a>0x0046</h3><pre class="language-none"><code class="language-none">Check out handle 0x0046 and do what it says. Keep in mind that this notification clallange requires you to recieve multiple responses in order to complete.</code></pre>

<p>读取0x0046句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0046</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031531936.png" alt="image-20240303153143862"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031532236.png" alt="image-20240303153200158"></p>
<p>一样需要监听，不同的是会发送多条通知：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0046 <span class="token parameter variable">-n</span> 00 <span class="token parameter variable">--listen</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031533322.png" alt="image-20240303153323157"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031533307.png" alt="image-20240303153341250"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"c9457de5fd8cafe349fd"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031534228.png" alt="image-20240303153430093"></p>
<h3 id="0x0048"><a href="#0x0048" class="headerlink" title="0x0048"></a>0x0048</h3><pre class="language-none"><code class="language-none">Check out handle 0x0048 and google search gatt indicate. Keep in mind that this chalange will require you to parse multiple indicate responses in order to complete the chalange.</code></pre>

<p>读取0x0048句柄（原文估计写错了）：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0048</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031545144.png" alt="image-20240303154541059"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031545246.png" alt="image-20240303154552175"></p>
<p>需要监听0x004a句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x004a <span class="token parameter variable">-n</span> 00 <span class="token parameter variable">--listen</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031552310.png"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031553695.png" alt="image-20240303155330649"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"b6f3a47f207d38e16ffa"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031554652.png" alt="image-20240303155412524"></p>
<h3 id="0x004c"><a href="#0x004c" class="headerlink" title="0x004c"></a>0x004c</h3><pre class="language-none"><code class="language-none">Check out handle 0x004c and do what it says. Much like ethernet or wifi devices, you can also change your bluetooth devices mac address.</code></pre>

<p>读取0x004c句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x004c</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031557894.png" alt="image-20240303155717811"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031557239.png" alt="image-20240303155733165"></p>
<p>需要我们修改本地连接设备的MAC地址为11:22:33:44:55:66去连接目标设备&#x3D;&#x3D;》也就是修改hci0：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031600399.png" alt="image-20240303160053300"></p>
<p>通过bdaddr修改：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#安装</span>
<span class="token function">git</span> clone https://github.com/thxomas/bdaddr.git
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libbluetooth-dev
<span class="token builtin class-name">cd</span> bdaddr
<span class="token function">make</span>

<span class="token comment">#修改</span>
<span class="token function">sudo</span> ./tools/bdaddr/bdaddr <span class="token parameter variable">-t</span> <span class="token parameter variable">-i</span> hci0 <span class="token number">11</span>:22:33:44:55:66</code></pre>

<p>失败</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403031827226.png" alt="image-20240303182754139"></p>
<p>暂时先提交上flag，等后续试试能不能解决</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"aca16920583e42bdcf5f"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032059720.png" alt="image-20240303205957630"></p>
<h3 id="0x004e"><a href="#0x004e" class="headerlink" title="0x004e"></a>0x004e</h3><pre class="language-none"><code class="language-none">Read handle 0x004e and do what it says. Setting MTU can be a tricky thing. Some tools may provide mtu flags, but they dont seem to really trigger MTU negotiations on servers. Try using gatttool&#39;s interactive mode for this task. By default, the BLECTF server is set to force an MTU size of 20. The server will listen for MTU negotiations, and look at them, but we dont really change the MTU in the code. We just trigger the flag code if you trigger an MTU event with the value specified in handle 0x0048. GLHF!</code></pre>

<p>读取0x004e：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x004e</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032101824.png" alt="image-20240303210149751"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032101248.png" alt="image-20240303210134194"></p>
<p>这里需要用到gatttool的交互模式才能指定MTU的大小：命令行中的-m参数并不具备此功能</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 <span class="token parameter variable">-I</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032201985.png" alt="image-20240303220155905"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032203148.png" alt="image-20240303220336091"></p>
<p>提交flag：</p>
<pre class="language-none"><code class="language-none">gatttool -b D8:BC:38:F9:72:12 --char-write-req -a 0x002c -n $(echo -n &quot;b1e409e5a4eaf9fe5158&quot;|xxd -ps)</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032204206.png" alt="image-20240303220454110"></p>
<h3 id="0x0050"><a href="#0x0050" class="headerlink" title="0x0050"></a>0x0050</h3><pre class="language-none"><code class="language-none">Check out handle 0x0050 and do what it says. This chalange differs from other write chalanges as your tool that does the write needs to have write response ack messages implemente correctly. This flag is also tricky as the flag will come back as notification response data even though there is no &quot;NOTIFY&quot; property.</code></pre>

<p>读取0x0050句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0050</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032207270.png"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032208973.png"></p>
<p>需要写入一个’hello’：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0050 <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"hello"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032212086.png" alt="image-20240303221228010"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032214137.png" alt="image-20240303221400104"></p>
<p>提交flag：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"d41d8cd98f00b204e980"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032213899.png" alt="image-20240303221346758"></p>
<h3 id="0x0052"><a href="#0x0052" class="headerlink" title="0x0052"></a>0x0052</h3><pre class="language-none"><code class="language-none">Take a look at handle 0x0052. Notice it does not have a notify property. Do a write here and listen for notifications anyways! Things are not always what they seem!</code></pre>

<p>读取0x0052句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0052</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032215172.png" alt="image-20240303221521116"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032215545.png"></p>
<p>根据提供消息说是没用通知&#x3D;&#x3D;》监听一下试试：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0052 <span class="token parameter variable">-n</span> 00 <span class="token parameter variable">--listen</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032218452.png" alt="image-20240303221840369"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032219900.png" alt="image-20240303221901843"></p>
<p>直接就是flag了。。</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"fc920c68b6006169477b"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032220529.png" alt="image-20240303222019402"></p>
<h3 id="0x0054"><a href="#0x0054" class="headerlink" title="0x0054"></a>0x0054</h3><pre class="language-none"><code class="language-none">Check out all of the handle properties on 0x0054! Poke around with all of them and find pieces to your flag.</code></pre>

<p>读取0x0054句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0054</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032223727.png" alt="image-20240303222309657"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032223086.png" alt="image-20240303222327050"></p>
<p>需要我们既要读又要写还要监听&#x3D;&#x3D;》</p>
<p>直接读的话又是提示信息，所以先写</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0054 <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"Closure"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span>

gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0054</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032228789.png" alt="image-20240303222826696"></p>
<p>监听&#x3D;&#x3D;》</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x0054 <span class="token parameter variable">-n</span> 00 <span class="token parameter variable">--listen</span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032230744.png" alt="image-20240303223001663"></p>
<p>将两部分拼接一下提交试试：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032230642.png" alt="image-20240303223040579"></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"fbb966958f07e4a0cc48"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032231309.png"></p>
<h3 id="0x0056"><a href="#0x0056" class="headerlink" title="0x0056"></a>0x0056</h3><pre class="language-none"><code class="language-none">Figure out the authors twitter handle and do what 0x0056 tells you to do!</code></pre>

<p>读取0x0056句柄：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-read <span class="token parameter variable">-a</span> 0x0056</code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032234472.png" alt="image-20240303223423386"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032234680.png" alt="image-20240303223412602"></p>
<p>作者的MD5，在README文件最上方就有：</p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032235240.png" alt="image-20240303223551178"></p>
<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032241924.png" alt="image-20240303224113880"></p>
<p>截取前20字节提交：</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">gatttool <span class="token parameter variable">-b</span> D8:BC:38:F9:72:12 --char-write-req <span class="token parameter variable">-a</span> 0x002c <span class="token parameter variable">-n</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"d953bfb9846acc2e15ee"</span><span class="token operator">|</span>xxd <span class="token parameter variable">-ps</span><span class="token variable">)</span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/zh-Closure/images/main/202403032243854.png" alt="image-20240303224306725"></p>
<p>结束结束</p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2023/11/05/Bypass-Canary/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>上一页</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="更新时间"></i>
              2024-03-03 22:46:00
            </span>
            
                  <span class="post-tags">
                    <i class="iconfont icon-tags mr-10" title="标签"></i>
                    
                    <span class="span--tag mr-8">
                      <a href="/tags/BLE/" title="BLE">
                        #BLE
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/2024/03/17/esp32ctf-thu/" target="_self">
                <span>下一页</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">目录</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BLE-CTF"><span class="toc-text">BLE_CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2"><span class="toc-text">环境部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E6%8C%91%E6%88%98"><span class="toc-text">开始挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x002e"><span class="toc-text">0x002e</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0030"><span class="toc-text">0x0030</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0016"><span class="toc-text">0x0016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0032"><span class="toc-text">0x0032</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0034"><span class="toc-text">0x0034</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0036"><span class="toc-text">0x0036</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0038"><span class="toc-text">0x0038</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x003c"><span class="toc-text">0x003c</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x003e"><span class="toc-text">0x003e</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0040"><span class="toc-text">0x0040</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0042"><span class="toc-text">0x0042</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0046"><span class="toc-text">0x0046</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0048"><span class="toc-text">0x0048</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x004c"><span class="toc-text">0x004c</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x004e"><span class="toc-text">0x004e</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0050"><span class="toc-text">0x0050</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0052"><span class="toc-text">0x0052</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0054"><span class="toc-text">0x0054</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0056"><span class="toc-text">0x0056</span></a></li></ol></li></ol></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" target="_blank" rel="noopener" href="https://github.com/zh-Closure">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zh-Closure">Copyright © 2024 Closure</a>
        
    </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zh-Closure">email | 765003952@qq.com</a>
        
    </div>
  
  
    <div class="footer-views">
      
          本站总访问量<span id="busuanzi_value_site_pv"></span>次
        
      
      
          本站访客数<span id="busuanzi_value_site_uv"></span>人
        
      
    </div>
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="可露希尔大涨价……">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + BLE_CTF + '&url=' + http%3A%2F%2Fexample.com%2F2024%2F03%2F03%2FBLE-CTF%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=http://example.com/2024/03/03/BLE-CTF/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
